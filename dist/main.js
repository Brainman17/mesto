(()=>{"use strict";class t{constructor(t,e){this._formElement=e,this._config=t}_checkInputValidity=t=>{const e=document.querySelector(`#${t.id}-error`);t.validity.valid?(e.textContent="",t.classList.remove(this._config.errorClass,this._config.inputMarginOut),e.classList.remove(this._config.inputErrorClass)):(e.textContent=t.validationMessage,t.classList.add(this._config.errorClass,this._config.inputMarginOut),e.classList.add(this._config.inputErrorClass))};_toggleButtonVisibility=()=>{this._inputs.every((t=>t.validity.valid))?(this._button.classList.remove(this._config.inactiveButtonClass),this._button.disabled=!1):(this._button.classList.add(this._config.inactiveButtonClass),this._button.disabled=!0)};enableValidation=()=>{this._inputs=[...this._formElement.querySelectorAll(this._config.inputSelector)],this._button=this._formElement.querySelector(this._config.submitButtonSelector),this._formElement.addEventListener("submit",(t=>{t.preventDefault()})),this._formElement.addEventListener("reset",(()=>{setTimeout((()=>{this._toggleButtonVisibility()}),0)})),this._inputs.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonVisibility()}))}))}}class e{constructor(t,e,s){this._data=t,this._templateSelector=e,this._handleImageClick=s}_getTemplate=()=>document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0);_handleDeleteButtonClick(){this._cardTemplate.remove()}_handleLikeButtonClick(){this._buttonLike.classList.toggle("card__heart-button_active")}_addEventListeners(){this._buttonDelete=this._cardTemplate.querySelector(".card__delete-button"),this._buttonLike=this._cardTemplate.querySelector(".card__heart-button"),this._buttonDelete.addEventListener("click",(()=>this._handleDeleteButtonClick())),this._buttonLike.addEventListener("click",(()=>this._handleLikeButtonClick())),this._cardElementImage.addEventListener("click",(()=>this._handleImageClick(this._data.name,this._data.link)))}generateCard(){return this._cardTemplate=this._getTemplate(),this._cardElementImage=this._cardTemplate.querySelector(".card__image"),this._cardElementTitle=this._cardTemplate.querySelector(".card__subtitle"),this._cardElementImage.src=this._data.link,this._cardElementImage.alt=this._data.name,this._cardElementTitle.textContent=this._data.name,this._addEventListeners(),this._cardTemplate}}const s={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_invalid",inputMarginOut:"popup__input_margin_out",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};class n{constructor(t){this._popup=document.querySelector(t)}_handleEscClose=t=>{"Escape"===t.key&&this.close()};open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}setEventListeners(){this._popup.addEventListener("mousedown",(t=>{t.target.classList.contains("popup_opened")&&this.close(),t.target.classList.contains("popup__close-button")&&this.close()}))}}class i extends n{constructor(t,e){super(t),this._handleSubmit=e,this._form=this._popup.querySelector(".popup__form"),this._inputs=[...this._form.querySelectorAll(".popup__input")]}_getInputValues(){const t={};return this._inputs.forEach((e=>{const s=e.name,n=e.value;t[s]=n})),t}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(t=>{this._handleSubmit(t,this._getInputValues())}))}close(){super.close(),this._form.reset()}setFormValues(t){this._inputs.forEach((e=>{const s=e.name;t[s]&&(e.value=t[s])}))}}const o=document.querySelector(".profile__add-button"),r=document.querySelector(".profile__edit-button"),a=document.forms["form-edit"],l=document.forms["form-add"];function c(t){const s=new e(t,"#card-template",u).generateCard();p.addItem(s)}function u(t,e){h.open(t,e)}o.addEventListener("click",(()=>{_.open()})),r.addEventListener("click",(()=>{const{name:t,about:e}=m.getUserInfo();d.setFormValues({name:t,about:e}),d.open()}));const p=new class{constructor({initialCards:t,renderer:e},s){this._initialCards=t,this._renderer=e,this._cardsContainer=document.querySelector(s)}renderItems(){this._initialCards.forEach((t=>{this._renderer(t)}))}addItem(t){this._cardsContainer.prepend(t)}}({initialCards:[{name:"Берлин",link:"https://traveltimes.ru/wp-content/uploads/2021/12/47360711626126273.jpg"},{name:"Москва",link:"https://sportishka.com/uploads/posts/2022-04/1650683238_58-sportishka-com-p-nochnaya-moskva-krasivo-foto-63.jpg"},{name:"Томск",link:"https://putdor.ru/upload/iblock/32e/32ec871f7122ecee00e8f5a460157eb3.jpg"},{name:"Байкал",link:"https://kartinkin.net/pics/uploads/posts/2022-08/1659704649_31-kartinkin-net-p-vodorosli-baikala-priroda-krasivo-foto-32.jpg"},{name:"Эльбрус",link:"https://kartinkin.net/pics/uploads/posts/2022-07/1658534305_22-kartinkin-net-p-elbrus-s-severa-priroda-krasivo-foto-22.jpg"},{name:"Карелия",link:"https://cdn.fishki.net/upload/post/2021/05/13/3750547/06f4136fb284d0e9c435139e11ed9c78.jpg"}],renderer:t=>{c(t)}},".cards");p.renderItems();const _=new i(".popup_add",(function(t,e){t.preventDefault(),c(e),_.close()}));_.setEventListeners();const d=new i(".popup_edit",(function(t,e){t.preventDefault(),m.setUserInfo(e.name,e.about),d.close()}));d.setEventListeners();const h=new class extends n{open(t,e){const s=this._popup.querySelector(".popup__card-img");this._popup.querySelector(".popup__card-subtitle").textContent=t,s.alt=t,s.src=e,super.open()}}(".popup_card");h.setEventListeners();const m=new class{constructor({userNameSelector:t,userJobSelector:e}){this._name=document.querySelector(t),this._job=document.querySelector(e)}getUserInfo(){return{name:this._name.textContent,about:this._job.textContent}}setUserInfo(t,e){this._name.textContent=t,this._job.textContent=e}}({userNameSelector:".profile__title",userJobSelector:".profile__subtitle"});new t(s,a).enableValidation(),new t(s,l).enableValidation()})();